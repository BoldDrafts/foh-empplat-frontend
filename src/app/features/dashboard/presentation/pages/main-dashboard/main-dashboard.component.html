<div class="dashboard-wrapper">
  <aside class="sidebar">
    <div class="sidebar-header">
      <h2 class="logo">Financiera<span class="logo-highlight">Oh</span></h2>
      <p class="sidebar-title">Portal<br>Empleador</p>
    </div>

    <nav class="sidebar-nav">
      <a routerLink="/dashboard" routerLinkActive="active" class="nav-item">
        <mat-icon>home</mat-icon>
        <span>Inicio</span>
      </a>
      <a routerLink="/accounts" routerLinkActive="active" class="nav-item">
        <mat-icon>credit_card</mat-icon>
        <span>Cuentas<br>sueldo</span>
      </a>
      <a routerLink="/payroll" routerLinkActive="active" class="nav-item">
        <mat-icon>receipt_long</mat-icon>
        <span>Pago de<br>haberes</span>
      </a>
      <a routerLink="/transfers" routerLinkActive="active" class="nav-item">
        <mat-icon>swap_horiz</mat-icon>
        <span>Transferencias</span>
      </a>
      <a routerLink="/reports" routerLinkActive="active" class="nav-item">
        <mat-icon>folder</mat-icon>
        <span>Reportes</span>
      </a>
    </nav>
  </aside>

  <main class="main-content">
    <header class="top-header">
      <div class="header-left">
        <h1>Hola, {{ userInfo.name }}</h1>
        <mat-form-field appearance="outline" class="company-selector">
          <mat-select [(value)]="selectedCompany">
            <mat-option *ngFor="let company of companies" [value]="company.name">
              {{ company.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="header-right">
        <button mat-icon-button class="notification-btn">
          <mat-icon matBadge="3" matBadgeColor="warn">notifications</mat-icon>
        </button>
        <button mat-icon-button [matMenuTriggerFor]="userMenu">
          <mat-icon>account_circle</mat-icon>
        </button>
        <mat-menu #userMenu="matMenu">
          <div class="user-menu-header">
            <div class="user-info">
              <strong>{{ userInfo.name }}</strong>
              <span class="user-email">{{ userInfo.email }}</span>
            </div>
          </div>
          <mat-divider></mat-divider>
          <button mat-menu-item (click)="logout()">
            <mat-icon>exit_to_app</mat-icon>
            <span>Cerrar sesión</span>
          </button>
        </mat-menu>
      </div>
    </header>

    <div class="dashboard-content">
      <mat-card class="info-card user-info-card">
        <mat-card-header>
          <div class="card-icon user-icon">
            <mat-icon>person</mat-icon>
          </div>
          <mat-card-title>Información del usuario</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="info-grid">
            <div class="info-item">
              <span class="label">Nombre</span>
              <span class="value">{{ userInfo.name }}</span>
            </div>
            <div class="info-item">
              <span class="label">DNI</span>
              <span class="value">{{ userInfo.dni }}</span>
            </div>
            <div class="info-item">
              <span class="label">Razón Social</span>
              <span class="value">{{ userInfo.companyName }}</span>
            </div>
            <div class="info-item">
              <span class="label">RUC</span>
              <span class="value">{{ userInfo.ruc }}</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="info-card account-info-card">
        <mat-card-header>
          <div class="card-icon account-icon">
            <mat-icon>account_balance</mat-icon>
          </div>
          <mat-card-title>Información de cuenta</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="table-container">
            <table mat-table [dataSource]="accounts" class="accounts-table">
              <ng-container matColumnDef="accountNumber">
                <th mat-header-cell *matHeaderCellDef>Número de cuenta</th>
                <td mat-cell *matCellDef="let account">{{ account.number }}</td>
              </ng-container>

              <ng-container matColumnDef="cci">
                <th mat-header-cell *matHeaderCellDef>CCI</th>
                <td mat-cell *matCellDef="let account">{{ account.cci }}</td>
              </ng-container>

              <ng-container matColumnDef="availableBalance">
                <th mat-header-cell *matHeaderCellDef>Saldo disponible</th>
                <td mat-cell *matCellDef="let account" class="amount">
                  {{ account.currency }} {{ account.availableBalance | number:'1.2-2' }}
                </td>
              </ng-container>

              <ng-container matColumnDef="retainedBalance">
                <th mat-header-cell *matHeaderCellDef>Saldo retenido</th>
                <td mat-cell *matCellDef="let account" class="amount">
                  {{ account.currency }} {{ account.retainedBalance | number:'1.2-2' }}
                </td>
              </ng-container>

              <ng-container matColumnDef="currency">
                <th mat-header-cell *matHeaderCellDef>Moneda</th>
                <td mat-cell *matCellDef="let account">{{ account.currency }}</td>
              </ng-container>

              <ng-container matColumnDef="status">
                <th mat-header-cell *matHeaderCellDef>Estado de cuenta</th>
                <td mat-cell *matCellDef="let account">
                  <span class="status-badge" [class.active]="account.status === 'ACTIVO'">
                    {{ account.status }}
                  </span>
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="reports-card">
        <mat-card-header>
          <mat-card-title>Reportes disponibles</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="reports-grid">
            <button
              mat-stroked-button
              *ngFor="let report of reports"
              class="report-button"
              (click)="openReport(report.type)">
              <mat-icon>{{ report.icon }}</mat-icon>
              <span>{{ report.name }}</span>
            </button>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </main>
</div>
